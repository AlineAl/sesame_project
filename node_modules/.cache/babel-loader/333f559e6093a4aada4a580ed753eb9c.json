{"ast":null,"code":"import _defineProperty from\"/Users/aline/Desktop/Projects/sesame_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/Users/aline/Desktop/Projects/sesame_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/aline/Desktop/Projects/sesame_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/aline/Desktop/Projects/sesame_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/aline/Desktop/Projects/sesame_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import axios from'axios';import jwtDecode from'jwt-decode';import{Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function LoginAdmin(){var _useState=useState({identifier:\"\",password:\"\"}),_useState2=_slicedToArray(_useState,2),credentials=_useState2[0],setCredentials=_useState2[1];var loginSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(event){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:event.preventDefault();_context.next=3;return axios.post('http://localhost:1337/api/auth/local',{identifier:credentials.identifier,password:credentials.password}).then(function(response){console.log(response);window.localStorage.setItem('authToken',response.data.jwt);window.localStorage.setItem('username',response.data.user.username);axios.defaults.headers[\"Authorization\"]=\"Bearer\"+response.data.jwt;console.log(isAuthenticated());}).catch(function(error){console.log('An error occurred:',error.response);});case 3:case\"end\":return _context.stop();}}},_callee);}));return function loginSubmit(_x){return _ref.apply(this,arguments);};}();function isAuthenticated(){var token=window.localStorage.getItem('authToken');if(token){var _jwtDecode=jwtDecode(token),exp=_jwtDecode.exp;if(exp*1000>new Date().getTime()){return true;}}return false;}isAuthenticated();var handleChange=function handleChange(_ref2){var currentTarget=_ref2.currentTarget;var value=currentTarget.value,name=currentTarget.name;setCredentials(_objectSpread(_objectSpread({},credentials),{},_defineProperty({},name,value)));};var displaySelectClosing=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var select;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:select=document.querySelector(\".select-navbar\");if(select.style.display===\"inline-block\"){select.style.display=\"none\";}else{select.style.display=\"inline-block\";}case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function displaySelectClosing(){return _ref3.apply(this,arguments);};}();var displayListNavBarMedia=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var navBarMedia;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:navBarMedia=document.querySelector(\".list-navbar-media\");if(navBarMedia.style.display===\"block\"){navBarMedia.style.display=\"none\";}else{navBarMedia.style.display=\"block\";}case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function displayListNavBarMedia(){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"nav\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"navbar\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo-sesame\",children:/*#__PURE__*/_jsx(Link,{to:\"/home\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"S\\xE9same \\u0153uvre-toi\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"icon-navbar\",onClick:displayListNavBarMedia,children:/*#__PURE__*/_jsx(\"i\",{class:\"fas fa-bars\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"list-navbar-media\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(Link,{to:\"/apropos\",children:/*#__PURE__*/_jsx(\"li\",{className:\"list-navbar-media-1\",children:\"\\xC0 propos\"})}),/*#__PURE__*/_jsx(Link,{to:\"/academie\",children:/*#__PURE__*/_jsx(\"li\",{className:\"list-navbar-media-2\",children:\"J'ouvre les portes de l'acad\\xE9mie\"})}),/*#__PURE__*/_jsx(Link,{to:\"/jedecouvre\",children:/*#__PURE__*/_jsx(\"li\",{className:\"list-navbar-media-3\",children:\"Je d\\xE9couvre\"})}),/*#__PURE__*/_jsx(Link,{to:\"/chronique\",children:/*#__PURE__*/_jsx(\"li\",{className:\"list-navbar-media-4\",children:\"Chronique lifestyle\"})}),/*#__PURE__*/_jsx(Link,{to:\"/oeuvretoi\",children:/*#__PURE__*/_jsx(\"li\",{className:\"list-navbar-media-5\",children:\"Oeuvre-toi\"})}),/*#__PURE__*/_jsx(Link,{to:\"/contact\",children:/*#__PURE__*/_jsx(\"li\",{className:\"list-navbar-media-6\",children:\"Contact\"})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"navbar-desktop\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo-sesame\",children:/*#__PURE__*/_jsx(Link,{to:\"/home\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"S\\xE9same \\u0153uvre-toi\"})})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(Link,{to:\"/apropos\",children:/*#__PURE__*/_jsx(\"li\",{children:\"\\xC0 propos\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"li\",{id:\"closing-list-nav\",onClick:displaySelectClosing,children:\"Closing \\u25BF\"}),/*#__PURE__*/_jsx(\"div\",{className:\"select-navbar\",children:/*#__PURE__*/_jsxs(\"ul\",{name:\"closings\",id:\"closings\",children:[/*#__PURE__*/_jsx(Link,{to:\"/academie\",children:/*#__PURE__*/_jsx(\"li\",{children:\"J'ouvre les portes de l'acad\\xE9mie\"})}),/*#__PURE__*/_jsx(Link,{to:\"/jedecouvre\",children:/*#__PURE__*/_jsx(\"li\",{children:\"Je d\\xE9couvre\"})})]})})]}),/*#__PURE__*/_jsx(Link,{to:\"/chronique\",children:/*#__PURE__*/_jsx(\"li\",{children:\"Chronique lifestyle\"})}),/*#__PURE__*/_jsx(Link,{to:\"/oeuvretoi\",children:/*#__PURE__*/_jsx(\"li\",{children:\"Oeuvre-toi\"})}),/*#__PURE__*/_jsx(Link,{to:\"/contact\",children:/*#__PURE__*/_jsx(\"li\",{children:\"Contact\"})})]})})]})]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:loginSubmit,children:[/*#__PURE__*/_jsx(\"label\",{children:\"Nom\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"identifier\",name:\"identifier\",onChange:handleChange}),/*#__PURE__*/_jsx(\"label\",{children:\"Mot de passe\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"password\",name:\"password\",onChange:handleChange}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Envoyer\",class:\"submit-form\"})]})]});}export default LoginAdmin;","map":{"version":3,"sources":["/Users/aline/Desktop/Projects/sesame_project/src/components/loginAdmin.jsx"],"names":["React","useState","axios","jwtDecode","Link","LoginAdmin","identifier","password","credentials","setCredentials","loginSubmit","event","preventDefault","post","then","response","console","log","window","localStorage","setItem","data","jwt","user","username","defaults","headers","isAuthenticated","catch","error","token","getItem","exp","Date","getTime","handleChange","currentTarget","value","name","displaySelectClosing","select","document","querySelector","style","display","displayListNavBarMedia","navBarMedia"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\nimport axios from 'axios';\nimport jwtDecode from 'jwt-decode';\nimport { Link } from \"react-router-dom\";\n\nfunction LoginAdmin() {\n    const [credentials, setCredentials] = useState({\n        identifier: \"\",\n        password: \"\"\n    });\n\n    const loginSubmit = async (event) => {\n        event.preventDefault();\n\n        await axios.post('http://localhost:1337/api/auth/local', {\n            identifier: credentials.identifier,\n            password: credentials.password\n        })\n        .then(response => {\n            console.log(response);\n            window.localStorage.setItem('authToken', response.data.jwt);\n            window.localStorage.setItem('username', response.data.user.username);\n            axios.defaults.headers[\"Authorization\"] = \"Bearer\" + response.data.jwt;\n            console.log(isAuthenticated());\n        })\n        .catch(error => {\n            console.log('An error occurred:', error.response);\n        });\n    }\n\n    function isAuthenticated(){\n        const token = window.localStorage.getItem('authToken');\n\n        if(token) {\n            const {exp} = jwtDecode(token);\n            if(exp * 1000 > new Date().getTime()) {\n                return true;\n            }\n        }\n        return false\n    }\n\n    isAuthenticated();\n\n    const handleChange = ({currentTarget}) => {\n        const {value, name} = currentTarget\n        setCredentials({\n            ...credentials,\n            [name]: value\n        })\n    }\n\n    const displaySelectClosing = async () => {\n        let select = document.querySelector(\".select-navbar\");\n\n        if(select.style.display === \"inline-block\") {\n            select.style.display = \"none\";\n        } else {\n            select.style.display = \"inline-block\";\n        }\n    }\n\n    const displayListNavBarMedia = async () => {\n        let navBarMedia = document.querySelector(\".list-navbar-media\");\n        \n        if(navBarMedia.style.display === \"block\") {\n            navBarMedia.style.display = \"none\";\n        } else {\n            navBarMedia.style.display = \"block\";\n        }\n    }\n\n    return (\n        <div>\n            <nav>\n                <div className=\"navbar\">\n                    <div className=\"logo-sesame\">\n                        <Link to=\"/home\"><h1>Sésame œuvre-toi</h1></Link>\n                    </div>\n                    <div className=\"icon-navbar\" onClick={displayListNavBarMedia}>\n                        <i class=\"fas fa-bars\"></i>\n                    </div>\n                </div>\n                <div className=\"list-navbar-media\">\n                    <ul>\n                        <Link to=\"/apropos\"><li className=\"list-navbar-media-1\">À propos</li></Link>\n                        <Link to=\"/academie\"><li className=\"list-navbar-media-2\">J'ouvre les portes de l'académie</li></Link>\n                        <Link to=\"/jedecouvre\"><li className=\"list-navbar-media-3\">Je découvre</li></Link>\n                        <Link to=\"/chronique\"><li className=\"list-navbar-media-4\">Chronique lifestyle</li></Link>\n                        <Link to=\"/oeuvretoi\"><li className=\"list-navbar-media-5\">Oeuvre-toi</li></Link>\n                        <Link to=\"/contact\"><li className=\"list-navbar-media-6\">Contact</li></Link>\n                    </ul>              \n                </div>\n                <div className=\"navbar-desktop\">\n                    <div className=\"logo-sesame\">\n                        <Link to=\"/home\"><h1>Sésame œuvre-toi</h1></Link>\n                    </div>\n                    <div>\n                        <ul>\n                            <Link to=\"/apropos\"><li>À propos</li></Link>\n                            <div>\n                                <li id=\"closing-list-nav\" onClick={displaySelectClosing}>Closing ▿</li>\n                                <div className=\"select-navbar\">\n                                    <ul name=\"closings\" id=\"closings\">\n                                        <Link to=\"/academie\"><li>J'ouvre les portes de l'académie</li></Link>\n                                        <Link to=\"/jedecouvre\"><li>Je découvre</li></Link>\n                                    </ul>\n                                </div>\n                            </div>\n                            <Link to=\"/chronique\"><li>Chronique lifestyle</li></Link>\n                            <Link to=\"/oeuvretoi\"><li>Oeuvre-toi</li></Link>\n                            <Link to=\"/contact\"><li>Contact</li></Link>\n                        </ul>                    \n                    </div>                    \n                </div>\n            </nav>\n\n            <form onSubmit={loginSubmit}>\n                <label>Nom</label>\n                <input type=\"text\" id=\"identifier\" name=\"identifier\" onChange={handleChange} />\n                <label>Mot de passe</label>\n                <input type=\"text\" id=\"password\" name=\"password\" onChange={handleChange}/>\n                <input type=\"submit\" value=\"Envoyer\" class=\"submit-form\" />\n            </form>            \n        </div>\n    )\n}\n\nexport default LoginAdmin;\n"]},"metadata":{},"sourceType":"module"}